input =
  [ "...........#..............##...",
    "...#....................#......",
    ".....####...........#.#..#.#...",
    "....##.#.......................",
    ".......#.##......#.###.........",
    ".#.....#.......##.......#.....#",
    "...........##....##.#....#.....",
    "......#.........#....#.........",
    "..###....#.........#....#.#....",
    "....#....#.#..#..#.........#.#.",
    "..........................#...#",
    ".##...........#...#.#.......#..",
    "#....##...#.#....#.............",
    "....#..##......##..#.#....#....",
    "#..........#.............#..#.#",
    "...#.####.....#..#.#.#..#...#..",
    "..........#......#........#..#.",
    "............#.....#..#..#....#.",
    ".................#...#.........",
    "..#...#...................#....",
    "..............##...#...........",
    "..........................#..#.",
    "#...#...#............#...#.....",
    ".................#..##.......#.",
    "............#....#.............",
    ".#......#.#...#....#...#.......",
    ".....#.....##..##.....#.......#",
    ".#..#..##...............#..#...",
    "#...#...##............#........",
    ".......#....#.......#..........",
    "...............................",
    "#................#...#.........",
    "...#...#..#..#.............##.#",
    "......#........#..............#",
    "...#.....##.#...#...#..........",
    ".........#..#........##.#...##.",
    "#.........##..#.......#........",
    "........##.#.#.................",
    ".#....#............###....#....",
    "...#.##....#.....##..#..#....#.",
    "....#..#........##..#...#..##..",
    "..........#............#.......",
    ".........#........##....#..##..",
    "#....#.........#.#.......#..#..",
    "...#....#......##.#............",
    "........#..#...............#...",
    "..............#.....#........#.",
    "......#..#.#........#..#..#.##.",
    "..#........###....#.#..........",
    "...#..#...#.#....##..#........#",
    "........#..#..............#....",
    "#.####.................#....##.",
    ".#................#............",
    "....#....#....#................",
    "#......#........##....#...#....",
    "......#..##..#..###...#.#.#....",
    ".#..........##.................",
    "...#...#....#...#.....#.....#..",
    "............#......##.........#",
    "..............##...............",
    "##....#....#...#...#....#..###.",
    "...................#.......##..",
    "#.....##........#....#.........",
    "...#.......#...........#.......",
    "...............##..............",
    "##.......#......#.....#........",
    "#....#..#..##..#.......#..#..#.",
    ".....#.............#.......#...",
    "......#..#........#.......#.#..",
    "..#...#...........#.##.........",
    "..#................####.#..#...",
    "......##....#.........#........",
    "..#..#.......#...##....#......#",
    "#.#..........#..............#.#",
    ".#.#..............#.##...#.....",
    "................#.....#.#......",
    "##.........#.........#.....#...",
    "....#.#.....................#..",
    "..#..#..#........#.......#.....",
    ".....#..#.#....#....#.....#....",
    "..####....#.#.........#........",
    "#..##...##..#.#............#..#",
    ".#........#..##.#.....#......##",
    ".##.##.....##....#.#...........",
    "....#..#.#..##............#.#..",
    "........#.#...#....#.........#.",
    ".....#.#.#.....#....#.....##...",
    "#...#..#....##..#..............",
    "..#...#....#...##..#.......#...",
    ".#....##.......................",
    ".........#............##.#..#..",
    "....#................#...#.#...",
    "...................#..#...#....",
    "#..#...................#.......",
    "..##..............#..........##",
    "...#.##......#.............#...",
    ".........#.#.........#.........",
    "...###......#.................#",
    "..........#....##..............",
    ".##..#....#.........#.#........",
    ".........#.......#.......#.#...",
    "#........#............#......#.",
    "....................#..........",
    ".......#...##..........#...#...",
    "....#.#.......#.#...##..#.#....",
    "...#..........#..............#.",
    "........##..............#......",
    "......#...##......#....##......",
    "....#.....#.#.##..............#",
    "...#...........#.#.............",
    "...........#......#.#..........",
    "...#.#......#......#...#...#...",
    "..#.......................#....",
    "...#...#..#..................#.",
    "##.....#.....#..#..#.....#...#.",
    ".#..#.......##.#.#.............",
    "......##.......##............#.",
    ".......#..#..#.......#....#.#..",
    "......#.....##..##...#........#",
    ".....#........#.##..........#..",
    "#....##............#........#..",
    ".....#..#...#............#...#.",
    "##.#....#........#.............",
    ".##...............##......#.#..",
    "###..#..#.......#.#..........#.",
    ".....#...........#...##........",
    "..#.#.#.........#.....#....#...",
    ".....#....##.......#..#.#......",
    "......#.....#...#..#...##..#...",
    ".....#....#................#...",
    "......#....#.#...##......##.#.#",
    ".....###.............#.........",
    ".................#......#####..",
    ".#.......#..........#.#....##..",
    "..#..#.......#.....#..#......##",
    "..........#.#.##.......##....#.",
    "##...#...##.##......#..###.....",
    "..#..#..#......#....#..........",
    "..#...#....#......#....#....#.#",
    ".#...#........#.....#......#..#",
    "#.........#......#.##.##.......",
    "#.##..#.............#.....#....",
    "....#.......#..#..##...##......",
    "...#.............#.#......#....",
    "#.....#..........##...##.....#.",
    "...............#........#....#.",
    "#.....#...#..#.............##..",
    ".#....##.#.......#.#..........#",
    "....#....#.#.....#....#......#.",
    "......#......#.................",
    ".#.#..#.#.#...#...#..#.##.#..##",
    ".............#.....#...........",
    "............#...#..#..#.....#..",
    ".#..........#.......#....#.....",
    "......#..###.#...#.............",
    "......#..........#.............",
    "....#.................#..#.#.#.",
    "...##.##.#....##.##............",
    "####......#........###......#..",
    "..#.......#.#..#.##............",
    ".....#.....#.#.......#.....#...",
    ".....#..........#.#............",
    "#.....#.............#......##..",
    "......##..........##....#......",
    ".#..............#..........#...",
    "......#..#...#........#..#....#",
    ".#......#.......#..#...........",
    "..#..#....#.#.......#....##..#.",
    "........#.#................#...",
    "#.......#.##.#......#...#.....#",
    "..#...#.#.....##...............",
    "..........#.....##.............",
    ".......#............#........#.",
    "...#............#......#......#",
    ".#..#.......#...#...#..#..#....",
    "#....#.#...#......#...#......#.",
    ".#.......#..#.#...........#....",
    "...##.#...#.......#..........#.",
    ".....#..............#..#...#...",
    "...........................#...",
    ".............#.....#...........",
    "....#.#..#..#...#..#...........",
    ".....#.#.#..#.#....#.#.#.......",
    ".......#..............#.....##.",
    "........#..#..#.#..#...#.#.....",
    ".....#.#...#.#.#.....#..#...#..",
    ".....#....#.......#......#.#...",
    ".#.#...........#........#......",
    ".##..##......#......#......#.#.",
    ".....#.###.#.......##.#..#.....",
    "#.......##..#.........#....#...",
    ".#.............#.........#.#.#.",
    "..........#..#..#....#....#....",
    "#....#...........##..#.....#..#",
    "......#....#...###..#...#......",
    ".....#....#........#....#..#...",
    "...##..............#.##...#....",
    ".#............#........##......",
    "..##........#.#...........#...#",
    "..#.#...##...#..#..........##..",
    ".................#.......#.....",
    "......#.....#............#.....",
    ".#.....#.........#.#..#.#......",
    ".............#.#.#..#.......#.#",
    "#......#.....#..##...#.......#.",
    ".......#.#..#...#.........#....",
    "...#..##...#.........#.#....#..",
    "........................#..#...",
    "....##..##................#....",
    ".......#..#.......#........##..",
    ".....#....#.##....#............",
    ".#....#............#.....#...#.",
    "..##.....#......#......#.#....#",
    "...#...........#...##....#.....",
    "......#.##.#..##...##.#.#..##..",
    ".......##....#......#....#.#...",
    ".....####..#............#..##..",
    "......##..##..##.........#...#.",
    ".#.#...............#.........#.",
    "......#......#...........#.....",
    ".....#.......##.....#..#.......",
    ".....##..#..#....#.#.......#...",
    "...........###.###.##..#.#..#..",
    ".#...............##.........#..",
    "......##..........#..#.....##.#",
    ".............#....#....#..##...",
    ".#..............#........#.....",
    ".#..#.........................#",
    ".##..............#..........#..",
    "..#..#.#.#.#......#............",
    "....#...#.#.#....#........#..#.",
    ".....#........#....#.....#.....",
    ".#...#.#......#..#........#.##.",
    ".......#.....#................#",
    ".#.#........................#..",
    "............#..#.......#.......",
    "....##.#........#...#.#.#.#.#..",
    ".....#.......##................",
    "...##...#....#.....#.#.........",
    "#...#..............#.......#...",
    "...#.#.#.#..##....##...........",
    ".....##...#....#.....#.........",
    "#......#.....#....#............",
    "....#..###....#.##.......#...#.",
    "..................##.#......#..",
    ".....##..............##.#....#.",
    ".........#...#........#..#....#",
    ".##..#.........#....#..##...#..",
    "#.#.##................#.##.....",
    "..#.#....#.#.......#....#......",
    "..#.#.##.#.......#.............",
    "..#....#.#..##.#..........#.#..",
    "#.....#.....#.....#.........#..",
    "#.......##.....#....##.....#...",
    "..#...#.........##.#..##.......",
    "..#.#.........#.......#........",
    "#.....#.....##.#.#..#...#..#.##",
    ".........................#.##..",
    "..#.#..#..#..#........#......#.",
    "..#..............#.............",
    ".....#.......##.##.....#.......",
    "....#...#...............#..#...",
    "....#......#.#........##.#..#.#",
    "....................#..#.......",
    ".....#.......#......#.##.......",
    "#.......##..........#.....#....",
    ".#.......#....#.#......#.......",
    "......#...#...............#.##.",
    "....##.#.....#.............#.##",
    "#..#................##...#.....",
    "....###......#.#.........#..#..",
    "...#...#......#...##....#...#.#",
    "..#...#.#.##.#.................",
    ".....##......#..#.#....#.......",
    "##.......#......#.#..#.#.......",
    ".#.#.#.........#...#.#..#......",
    "#...#.#........#....#.#.....#..",
    "....#.......##....#......##....",
    ".....#..........#......#....#..",
    "#...#....#...#.....#.#.........",
    "...#..##.....##....#.....#.#...",
    "..................#.....##.....",
    ".....#............#............",
    "...#.....#..#........#.#..##...",
    ".......#.#.....................",
    "......#...#.......#..#...#..#..",
    ".#..#...#.....##.....#.#.#....#",
    "....##...#.#............#..#..#",
    "...........#............#..#...",
    ".......#.....#................#",
    "..#......#.#.......#.#.........",
    ".....#..#.#.##.................",
    ".....#..#......................",
    "...#....#...#..#.#..#....#.....",
    ".#............#.....#..........",
    "#.##..#..#.......#......#.....#",
    ".#.........#....#....#.........",
    "...#.#.#........#.#....#...#...",
    "#........#..#..#..........#..#.",
    ".....#..#.....##......##..##.#.",
    "..............#.......#..#..#..",
    "....#........#.##.#...#........",
    "..#.#..#....#........##.....##.",
    "...##.....#...#.......#.#....#.",
    "#.....#..##.##.#...##.......#..",
    ".....#........#.#.#....#.......",
    ".#................#####..#.#...",
    "..........##..#..###....#......",
    ".....#.......#..........#..#...",
    "..#....#....................#..",
    "#.....#..#.....#...##.#.....#.#",
    "...#..##............#.....#....",
    "##.#..#.......##...............",
    "........##...#.#.....#......#..",
    "........#...#..................",
    "#......#................#.#....",
    "...........#...#..#.........#..",
    "...#.##..#.##..................",
    ".....#......###......#..#......",
    "..#.#.....#...#..#.##........#.",
    "....#..........#.#.....#.......",
    "..#..........#..........#.#....",
    "..#.##.......#......#.........."
  ]

getCharacterInLine :: Int -> [a] -> a
getCharacterInLine position line = do
  let index = position `mod` length line
  line !! index

didHitTree :: Int -> [Char] -> Bool
didHitTree position line
  | getCharacterInLine position line == '#' = True
  | otherwise = False

traverseGrid :: Int -> Int -> Int -> Int -> [[Char]] -> Int -> (Int, Int, Int, Int, [[Char]], Int)
traverseGrid level levelInc position positionInc grid encounterTrees 
    | level >= length grid = (length grid, levelInc, position, positionInc, grid, encounterTrees)
    | otherwise = traverseGrid (level + levelInc) levelInc (position + positionInc) positionInc grid (encounterTrees + newEncounters)
    where newEncounters = if didHitTree position (grid !! level) then 1 else 0

(_, _, _, _, _, result1) = traverseGrid 0 1 0 1 input 0
(_, _, _, _, _, result2) = traverseGrid 0 1 0 3 input 0
(_, _, _, _, _, result3) = traverseGrid 0 1 0 5 input 0
(_, _, _, _, _, result4) = traverseGrid 0 1 0 7 input 0
(_, _, _, _, _, result5) = traverseGrid 0 2 0 1 input 0

result = product [result1, result2, result3, result4, result5]
